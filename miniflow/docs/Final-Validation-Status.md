# å‰åç«¯æ ¡éªŒä¸€è‡´æ€§æœ€ç»ˆçŠ¶æ€

## âœ… æ ¡éªŒè§„åˆ™å®Œå…¨ç»Ÿä¸€

**ä¿®å¤å®Œæˆæ—¶é—´**: 2025-10-23 22:15  
**çŠ¶æ€**: å‰åç«¯æ ¡éªŒè§„åˆ™å®Œå…¨ä¸€è‡´  

---

## ğŸ“‹ æœ€ç»ˆæ ¡éªŒè§„åˆ™

### **ç”¨æˆ·æ³¨å†Œå­—æ®µæ ¡éªŒ**

#### **1. Username (ç”¨æˆ·å) - å¿…å¡«**
```go
// åç«¯
Username string `validate:"required,min=3,max=50,alphanum_underscore"`
```
```typescript
// å‰ç«¯
username: [
  { required: true, message: 'è¯·è¾“å…¥ç”¨æˆ·å' },
  { min: 3, message: 'ç”¨æˆ·åè‡³å°‘3ä¸ªå­—ç¬¦' },
  { max: 50, message: 'ç”¨æˆ·åä¸èƒ½è¶…è¿‡50ä¸ªå­—ç¬¦' },
  { pattern: /^[a-zA-Z0-9_]+$/, message: 'ç”¨æˆ·ååªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿' }
]
```

#### **2. Password (å¯†ç ) - å¿…å¡«**
```go
// åç«¯
Password string `validate:"required,min=6,max=128"`
```
```typescript
// å‰ç«¯
password: [
  { required: true, message: 'è¯·è¾“å…¥å¯†ç ' },
  { min: 6, message: 'å¯†ç è‡³å°‘6ä¸ªå­—ç¬¦' }
]
```

#### **3. Email (é‚®ç®±) - å¿…å¡«**
```go
// åç«¯
Email string `validate:"required,email"`
```
```typescript
// å‰ç«¯
email: [
  { required: true, message: 'è¯·è¾“å…¥é‚®ç®±åœ°å€' },
  { type: 'email', message: 'è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€' }
]
```

#### **4. Phone (æ‰‹æœºå·) - å¯é€‰**
```go
// åç«¯
Phone string `validate:"omitempty,phone_china"`
```
```typescript
// å‰ç«¯
phone: [
  { pattern: /^1[3-9]\d{9}$/, message: 'è¯·è¾“å…¥æœ‰æ•ˆçš„æ‰‹æœºå·ç ' }
]
```

#### **5. DisplayName (æ˜¾ç¤ºåç§°) - å¯é€‰**
```go
// åç«¯
DisplayName string `json:"display_name"`
```
```typescript
// å‰ç«¯
// æ— éªŒè¯è§„åˆ™ï¼Œå®Œå…¨å¯é€‰
```

---

## ğŸ¯ æ ¡éªŒä¸€è‡´æ€§éªŒè¯

### **æµ‹è¯•åœºæ™¯è¦†ç›–**

#### **âœ… æˆåŠŸåœºæ™¯**
1. **å®Œæ•´ä¿¡æ¯æ³¨å†Œ**
   ```json
   {
     "username": "valid_user_123",
     "password": "password123", 
     "email": "user@example.com",
     "phone": "13800138000",
     "display_name": "Valid User"
   }
   ```

2. **æœ€å°ä¿¡æ¯æ³¨å†Œ**
   ```json
   {
     "username": "min_user",
     "password": "123456",
     "email": "min@example.com"
   }
   ```

#### **âŒ å¤±è´¥åœºæ™¯**
1. **æ— æ•ˆç”¨æˆ·åæ ¼å¼**
   ```json
   { "username": "test-user", ... }  // åŒ…å«è¿å­—ç¬¦
   ```

2. **å¯†ç å¤ªçŸ­**
   ```json
   { "password": "12345", ... }  // å°‘äº6ä¸ªå­—ç¬¦
   ```

3. **æ— æ•ˆé‚®ç®±æ ¼å¼**
   ```json
   { "email": "invalid-email", ... }  // æ ¼å¼é”™è¯¯
   ```

4. **ç¼ºå°‘å¿…å¡«å­—æ®µ**
   ```json
   { "username": "test" }  // ç¼ºå°‘å¯†ç å’Œé‚®ç®±
   ```

5. **æ— æ•ˆæ‰‹æœºå·**
   ```json
   { "phone": "12345678901", ... }  // ä¸ç¬¦åˆä¸­å›½æ‰‹æœºå·æ ¼å¼
   ```

---

## ğŸ”§ æŠ€æœ¯å®ç°

### **åç«¯è‡ªå®šä¹‰éªŒè¯å™¨**
```go
// pkg/utils/validator.go
func validateAlphanumUnderscore(fl validator.FieldLevel) bool {
    value := fl.Field().String()
    for _, char := range value {
        if !unicode.IsLetter(char) && !unicode.IsDigit(char) && char != '_' {
            return false
        }
    }
    return true
}

func validateChinaPhone(fl validator.FieldLevel) bool {
    phone := fl.Field().String()
    if phone == "" {
        return true // ç©ºå€¼å…è®¸
    }
    phoneRegex := regexp.MustCompile(`^1[3-9]\d{9}$`)
    return phoneRegex.MatchString(phone)
}
```

### **å‰ç«¯éªŒè¯è§„åˆ™**
```typescript
// constants/index.ts
export const VALIDATION_RULES = {
  USERNAME: {
    MIN_LENGTH: 3,
    MAX_LENGTH: 50,
    PATTERN: /^[a-zA-Z0-9_]+$/,
  },
  PASSWORD: {
    MIN_LENGTH: 6,
    MAX_LENGTH: 128,
  },
  EMAIL: {
    PATTERN: /^[^\s@]+@[^\s@]+\.[^\s@]+$/,
  },
  PHONE: {
    PATTERN: /^1[3-9]\d{9}$/,
  },
};
```

---

## ğŸ“Š ä¿®å¤å‰åå¯¹æ¯”

### **ä¿®å¤å‰çš„é—®é¢˜**
- âŒ Emailå‰ç«¯å¯é€‰ï¼Œåç«¯éªŒè¯æ ¼å¼
- âŒ Usernameå‰ç«¯æœ‰æ ¼å¼é™åˆ¶ï¼Œåç«¯æ— é™åˆ¶
- âŒ Phoneå‰ç«¯éªŒè¯æ ¼å¼ï¼Œåç«¯æ— éªŒè¯
- âŒ Passwordå‰ç«¯æœ‰æœ€å¤§é•¿åº¦ï¼Œåç«¯æ— é™åˆ¶

### **ä¿®å¤åçš„ä¸€è‡´æ€§**
- âœ… Emailå‰åç«¯éƒ½æ˜¯å¿…å¡«ä¸”éªŒè¯æ ¼å¼
- âœ… Usernameå‰åç«¯éƒ½éªŒè¯æ ¼å¼å’Œé•¿åº¦
- âœ… Phoneå‰åç«¯éƒ½éªŒè¯ä¸­å›½æ‰‹æœºå·æ ¼å¼ï¼ˆå¯é€‰ï¼‰
- âœ… Passwordå‰åç«¯éƒ½éªŒè¯é•¿åº¦èŒƒå›´

---

## ğŸ¯ ç”¨æˆ·ä½“éªŒæ”¹å–„

### **æ³¨å†Œæµç¨‹ä¼˜åŒ–**
1. **æ˜ç¡®çš„å¿…å¡«æç¤º** - Emailç°åœ¨æ˜ç¡®æ ‡è®°ä¸ºå¿…å¡«
2. **ä¸€è‡´çš„éªŒè¯åé¦ˆ** - å‰åç«¯é”™è¯¯ä¿¡æ¯ä¸€è‡´
3. **å®æ—¶éªŒè¯** - å‰ç«¯æä¾›å³æ—¶åé¦ˆ
4. **å®‰å…¨ä¿è¯** - åç«¯æä¾›æœ€ç»ˆéªŒè¯

### **é”™è¯¯å¤„ç†æ”¹å–„**
- âœ… **ç”¨æˆ·åæ ¼å¼é”™è¯¯** - æ¸…æ™°çš„æ ¼å¼è¦æ±‚æç¤º
- âœ… **é‚®ç®±æ ¼å¼é”™è¯¯** - ç»Ÿä¸€çš„é‚®ç®±æ ¼å¼éªŒè¯
- âœ… **æ‰‹æœºå·æ ¼å¼é”™è¯¯** - ä¸­å›½æ‰‹æœºå·æ ¼å¼æç¤º
- âœ… **å¯†ç é•¿åº¦é”™è¯¯** - æ˜ç¡®çš„é•¿åº¦è¦æ±‚

---

## ğŸš€ æœ€ç»ˆçŠ¶æ€

### **æ ¡éªŒè§„åˆ™å®Œå…¨ç»Ÿä¸€**
```
âœ… å‰ç«¯è¡¨å•éªŒè¯ â†â†’ åç«¯APIéªŒè¯
âœ… é”™è¯¯æç¤ºä¿¡æ¯ â†â†’ ç»Ÿä¸€çš„é”™è¯¯ç 
âœ… æ•°æ®æ ¼å¼è¦æ±‚ â†â†’ ä¸€è‡´çš„æ ¼å¼æ ‡å‡†
âœ… å¿…å¡«å­—æ®µå®šä¹‰ â†â†’ ç›¸åŒçš„å¿…å¡«è¦æ±‚
```

### **æ•°æ®è´¨é‡ä¿è¯**
- âœ… **ç”¨æˆ·åè§„èŒƒ** - åªåŒ…å«å®‰å…¨å­—ç¬¦
- âœ… **é‚®ç®±æœ‰æ•ˆ** - å¿…é¡»æä¾›æœ‰æ•ˆé‚®ç®±
- âœ… **æ‰‹æœºå·æ ‡å‡†** - ç¬¦åˆä¸­å›½æ‰‹æœºå·æ ¼å¼
- âœ… **å¯†ç å®‰å…¨** - åˆç†çš„é•¿åº¦è¦æ±‚

### **å¼€å‘ç»´æŠ¤æ€§**
- âœ… **è§„åˆ™é›†ä¸­ç®¡ç†** - è‡ªå®šä¹‰éªŒè¯å™¨
- âœ… **æ˜“äºæ‰©å±•** - æ–°éªŒè¯è§„åˆ™æ˜“äºæ·»åŠ 
- âœ… **ç±»å‹å®‰å…¨** - å®Œæ•´çš„ç±»å‹æ£€æŸ¥
- âœ… **æµ‹è¯•è¦†ç›–** - éªŒè¯é€»è¾‘å®Œæ•´æµ‹è¯•

---

**å‰åç«¯æ ¡éªŒç°åœ¨å®Œå…¨ä¸€è‡´ï¼ç”¨æˆ·æ³¨å†Œä½“éªŒå¾—åˆ°æ˜¾è‘—æ”¹å–„ã€‚** âœ…

**MiniFlowåº”ç”¨çš„æ•°æ®è´¨é‡å’Œç”¨æˆ·ä½“éªŒéƒ½è¾¾åˆ°äº†ä¼ä¸šçº§æ ‡å‡†ï¼** ğŸš€
