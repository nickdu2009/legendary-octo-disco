# ç¬¬2å‘¨ Day 1 å¼€å‘æ€»ç»“

## ğŸ“… Day 6 (ç¬¬2å‘¨ Day 1) - Monday - 8å°æ—¶å®Œæˆ

**ä¸»é¢˜**: æµç¨‹æ•°æ®æ¨¡å‹è®¾è®¡å’Œåç«¯API  
**çŠ¶æ€**: âœ… å…¨éƒ¨å®Œæˆ  
**å®é™…ç”¨æ—¶**: 8å°æ—¶  

---

## âœ… å®Œæˆçš„äº¤ä»˜æ¸…å•

### 1. **æµç¨‹æ•°æ®æ¨¡å‹å®Œæˆ** âœ…
åˆ›å»ºäº†å®Œæ•´çš„æµç¨‹ç®¡ç†æ•°æ®æ¨¡å‹ (`internal/model/process.go`)ï¼š

**æ ¸å¿ƒæ¨¡å‹è®¾è®¡ï¼š**
```go
// æµç¨‹å®šä¹‰æ¨¡å‹
type ProcessDefinition struct {
    BaseModel
    Key            string  // æµç¨‹å”¯ä¸€æ ‡è¯†
    Name           string  // æµç¨‹åç§°
    Version        int     // ç‰ˆæœ¬å·
    Description    string  // æµç¨‹æè¿°
    Category       string  // æµç¨‹åˆ†ç±»
    DefinitionJSON string  // JSONæ ¼å¼çš„æµç¨‹å®šä¹‰
    Status         string  // çŠ¶æ€ï¼šdraft/published/archived
    CreatedBy      uint    // åˆ›å»ºè€…ID
}

// æµç¨‹å®ä¾‹æ¨¡å‹
type ProcessInstance struct {
    BaseModel
    DefinitionID uint      // å…³è”çš„æµç¨‹å®šä¹‰
    BusinessKey  string    // ä¸šåŠ¡æ ‡è¯†
    CurrentNode  string    // å½“å‰æ‰§è¡ŒèŠ‚ç‚¹
    Status       string    // å®ä¾‹çŠ¶æ€
    Variables    string    // æµç¨‹å˜é‡
    StartTime    time.Time // å¼€å§‹æ—¶é—´
    EndTime      *time.Time // ç»“æŸæ—¶é—´
    StarterID    uint      // å¯åŠ¨è€…ID
}

// ä»»åŠ¡å®ä¾‹æ¨¡å‹
type TaskInstance struct {
    BaseModel
    InstanceID   uint       // å…³è”çš„æµç¨‹å®ä¾‹
    NodeID       string     // èŠ‚ç‚¹ID
    Name         string     // ä»»åŠ¡åç§°
    AssigneeID   *uint      // åˆ†é…ç»™çš„ç”¨æˆ·
    Status       string     // ä»»åŠ¡çŠ¶æ€
    Priority     int        // ä¼˜å…ˆçº§
    DueDate      *time.Time // æˆªæ­¢æ—¶é—´
    ClaimTime    *time.Time // è®¤é¢†æ—¶é—´
    CompleteTime *time.Time // å®Œæˆæ—¶é—´
    Comment      string     // å¤„ç†æ„è§
    FormData     string     // è¡¨å•æ•°æ®
}
```

**æ•°æ®ç»“æ„è®¾è®¡ï¼š**
```go
// æµç¨‹èŠ‚ç‚¹å®šä¹‰
type ProcessNode struct {
    ID    string                 `json:"id"`
    Type  string                 `json:"type"` // start/end/userTask/serviceTask/gateway
    Name  string                 `json:"name"`
    X     float64                `json:"x"`
    Y     float64                `json:"y"`
    Props map[string]interface{} `json:"props,omitempty"`
}

// æµç¨‹è¿çº¿å®šä¹‰
type ProcessFlow struct {
    ID        string `json:"id"`
    From      string `json:"from"`
    To        string `json:"to"`
    Condition string `json:"condition,omitempty"`
    Label     string `json:"label,omitempty"`
}
```

### 2. **æµç¨‹Repositoryå±‚å®ç°** âœ…
å®ç°äº†å®Œæ•´çš„æ•°æ®è®¿é—®å±‚ (`internal/repository/process.go`)ï¼š

**æ ¸å¿ƒåŠŸèƒ½æ–¹æ³•ï¼ˆ15ä¸ªï¼‰ï¼š**
- `Create(process)` - åˆ›å»ºæµç¨‹å®šä¹‰
- `GetByID(id)` - æŒ‰IDæŸ¥è¯¢
- `GetByKey(key)` - æŒ‰æ ‡è¯†æŸ¥è¯¢æœ€æ–°ç‰ˆæœ¬
- `GetByKeyAndVersion(key, version)` - æŸ¥è¯¢ç‰¹å®šç‰ˆæœ¬
- `Update(process)` - æ›´æ–°æµç¨‹å®šä¹‰
- `Delete(id)` - è½¯åˆ é™¤æµç¨‹å®šä¹‰
- `List(offset, limit, filters)` - åˆ†é¡µæŸ¥è¯¢å’Œç­›é€‰

**ç‰ˆæœ¬ç®¡ç†åŠŸèƒ½ï¼š**
- `GetLatestVersion(key)` - è·å–æœ€æ–°ç‰ˆæœ¬
- `GetVersions(key)` - è·å–æ‰€æœ‰ç‰ˆæœ¬
- `GetMaxVersion(key)` - è·å–æœ€å¤§ç‰ˆæœ¬å·

**ä¸šåŠ¡æŸ¥è¯¢åŠŸèƒ½ï¼š**
- `GetByCategory(category)` - æŒ‰åˆ†ç±»æŸ¥è¯¢
- `GetByCreator(createdBy)` - æŒ‰åˆ›å»ºè€…æŸ¥è¯¢
- `Search(keyword)` - å…³é”®è¯æœç´¢
- `ExistsByKey(key)` - æ£€æŸ¥æ ‡è¯†æ˜¯å¦å­˜åœ¨
- `CountByStatus/Creator` - ç»Ÿè®¡åŠŸèƒ½

### 3. **æµç¨‹Serviceå±‚ä¸šåŠ¡é€»è¾‘** âœ…
å®ç°äº†å®Œæ•´çš„ä¸šåŠ¡é€»è¾‘å±‚ (`internal/service/process.go`)ï¼š

**æ ¸å¿ƒä¸šåŠ¡æ–¹æ³•ï¼ˆ10ä¸ªï¼‰ï¼š**
- `CreateProcess(userID, req)` - åˆ›å»ºæµç¨‹
- `UpdateProcess(processID, userID, req)` - æ›´æ–°æµç¨‹
- `DeleteProcess(processID, userID)` - åˆ é™¤æµç¨‹
- `GetProcess(processID)` - è·å–æµç¨‹è¯¦æƒ…
- `GetUserProcesses(userID, page, pageSize)` - ç”¨æˆ·æµç¨‹åˆ—è¡¨
- `GetProcesses(page, pageSize, filters)` - æµç¨‹åˆ—è¡¨æŸ¥è¯¢
- `CopyProcess(processID, userID)` - å¤åˆ¶æµç¨‹
- `PublishProcess(processID, userID)` - å‘å¸ƒæµç¨‹

**æ•°æ®ä¼ è¾“å¯¹è±¡ï¼š**
```go
type CreateProcessRequest struct {
    Key         string                      `validate:"required,min=3,max=100"`
    Name        string                      `validate:"required,min=1,max=255"`
    Description string
    Category    string
    Definition  model.ProcessDefinitionData
}

type ProcessResponse struct {
    ID          uint
    Key         string
    Name        string
    Version     int
    Definition  model.ProcessDefinitionData
    // ... å…¶ä»–å­—æ®µ
}
```

**ä¸šåŠ¡é€»è¾‘ç‰¹æ€§ï¼š**
- **æƒé™éªŒè¯** - åªèƒ½ç¼–è¾‘/åˆ é™¤è‡ªå·±åˆ›å»ºçš„æµç¨‹
- **çŠ¶æ€æ§åˆ¶** - è‰ç¨¿å¯ç¼–è¾‘ï¼Œå·²å‘å¸ƒä¸å¯ç¼–è¾‘
- **æµç¨‹éªŒè¯** - éªŒè¯èŠ‚ç‚¹è¿çº¿çš„å®Œæ•´æ€§
- **ç‰ˆæœ¬ç®¡ç†** - è‡ªåŠ¨ç‰ˆæœ¬å·é€’å¢

### 4. **æµç¨‹Handlerå±‚APIæ¥å£** âœ…
å®ç°äº†å®Œæ•´çš„APIæ¥å£å±‚ (`internal/handler/process.go`)ï¼š

**RESTful APIæ¥å£ï¼ˆ7ä¸ªï¼‰ï¼š**
```go
POST   /api/v1/process           - åˆ›å»ºæµç¨‹å®šä¹‰
GET    /api/v1/process           - è·å–æµç¨‹åˆ—è¡¨ï¼ˆåˆ†é¡µã€ç­›é€‰ã€æœç´¢ï¼‰
GET    /api/v1/process/:id       - è·å–æµç¨‹è¯¦æƒ…
PUT    /api/v1/process/:id       - æ›´æ–°æµç¨‹å®šä¹‰
DELETE /api/v1/process/:id       - åˆ é™¤æµç¨‹å®šä¹‰
POST   /api/v1/process/:id/copy  - å¤åˆ¶æµç¨‹å®šä¹‰
POST   /api/v1/process/:id/publish - å‘å¸ƒæµç¨‹å®šä¹‰
```

**APIç‰¹æ€§ï¼š**
- **ç»Ÿä¸€é”™è¯¯å¤„ç†** - æ ‡å‡†åŒ–é”™è¯¯ç å’Œæ¶ˆæ¯
- **è¯·æ±‚éªŒè¯** - å®Œæ•´çš„å‚æ•°éªŒè¯
- **ç”¨æˆ·è®¤è¯** - JWT tokenéªŒè¯
- **æƒé™æ§åˆ¶** - åŸºäºç”¨æˆ·IDçš„æƒé™æ£€æŸ¥
- **æ—¥å¿—è®°å½•** - è¯¦ç»†çš„æ“ä½œå®¡è®¡æ—¥å¿—

### 5. **Wireä¾èµ–æ³¨å…¥é…ç½®æ›´æ–°** âœ…
å®Œæ•´é›†æˆäº†æµç¨‹ç®¡ç†ç»„ä»¶ï¼š

**ä¾èµ–æ³¨å…¥é“¾æ‰©å±•ï¼š**
```
Config â†’ Logger, Database, JWTManager
Database + Logger â†’ UserRepository, ProcessRepository
Repository + Logger â†’ UserService, ProcessService
Services + JWTManager + Logger â†’ Router
All Components â†’ Server
```

**æ›´æ–°çš„ç»„ä»¶ï¼š**
- `wire.go` - æ·»åŠ ProcessRepositoryå’ŒProcessService
- `router.go` - é›†æˆProcessHandlerå’Œè·¯ç”±é…ç½®
- `server.go` - æ›´æ–°æ„é€ å‡½æ•°å‚æ•°

### 6. **æ•°æ®åº“è¿ç§»åŠŸèƒ½** âœ…
å®Œæ•´çš„æ•°æ®åº“è¡¨ç»“æ„åˆ›å»ºï¼š

**ä»æœåŠ¡å™¨æ—¥å¿—å¯ä»¥çœ‹åˆ°æˆåŠŸåˆ›å»ºçš„è¡¨ï¼š**
- âœ… `process_definitions` - æµç¨‹å®šä¹‰è¡¨
- âœ… `process_instances` - æµç¨‹å®ä¾‹è¡¨  
- âœ… `task_instances` - ä»»åŠ¡å®ä¾‹è¡¨
- âœ… æ‰€æœ‰ç´¢å¼•å’Œå¤–é”®çº¦æŸæ­£ç¡®åˆ›å»º
- âœ… æ•°æ®åº“è¿ç§»è€—æ—¶çº¦2ç§’ï¼Œæ€§èƒ½è‰¯å¥½

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„æ‰©å±•

### **åç«¯æ¶æ„å¢å¼º**
```
åŸæœ‰æ¶æ„: Userç®¡ç† + JWTè®¤è¯
æ–°å¢æ¶æ„: Processç®¡ç† + æµç¨‹å¼•æ“åŸºç¡€
â”œâ”€â”€ Modelå±‚: 3ä¸ªæ–°æ¨¡å‹ + å…³è”å…³ç³»
â”œâ”€â”€ Repositoryå±‚: 15ä¸ªæ•°æ®è®¿é—®æ–¹æ³•
â”œâ”€â”€ Serviceå±‚: 10ä¸ªä¸šåŠ¡é€»è¾‘æ–¹æ³•
â””â”€â”€ Handlerå±‚: 7ä¸ªAPIæ¥å£
```

### **æ•°æ®åº“æ¶æ„æ‰©å±•**
```
åŸæœ‰è¡¨: users
æ–°å¢è¡¨: 
â”œâ”€â”€ process_definitions (æµç¨‹å®šä¹‰)
â”œâ”€â”€ process_instances (æµç¨‹å®ä¾‹)
â””â”€â”€ task_instances (ä»»åŠ¡å®ä¾‹)

å…³è”å…³ç³»:
users â†’ process_definitions (åˆ›å»ºè€…)
users â†’ process_instances (å¯åŠ¨è€…)
users â†’ task_instances (åˆ†é…è€…)
process_definitions â†’ process_instances (ä¸€å¯¹å¤š)
process_instances â†’ task_instances (ä¸€å¯¹å¤š)
```

### **APIæ¶æ„æ‰©å±•**
```
åŸæœ‰API: /api/v1/auth/* + /api/v1/user/*
æ–°å¢API: /api/v1/process/*
â”œâ”€â”€ æµç¨‹CRUDæ“ä½œ
â”œâ”€â”€ ç‰ˆæœ¬ç®¡ç†åŠŸèƒ½
â”œâ”€â”€ æƒé™æ§åˆ¶æœºåˆ¶
â””â”€â”€ ç»Ÿè®¡æŸ¥è¯¢åŠŸèƒ½
```

---

## ğŸ“Š ä»£ç ç»Ÿè®¡

| ç»„ä»¶ | æ–‡ä»¶ | è¡Œæ•° | ä¸»è¦åŠŸèƒ½ |
|------|------|------|----------|
| æ•°æ®æ¨¡å‹ | `model/process.go` | 170è¡Œ | 3ä¸ªæ¨¡å‹ + å¸¸é‡å®šä¹‰ |
| Repository | `repository/process.go` | 260è¡Œ | 15ä¸ªæ•°æ®è®¿é—®æ–¹æ³• |
| Service | `service/process.go` | 526è¡Œ | 10ä¸ªä¸šåŠ¡é€»è¾‘æ–¹æ³• |
| Handler | `handler/process.go` | 370è¡Œ | 7ä¸ªAPIæ¥å£å¤„ç† |
| é…ç½®æ›´æ–° | å¤šä¸ªæ–‡ä»¶ | 50è¡Œ | Wire + Router + Migration |
| **æ€»è®¡** | **5ä¸ªæ–‡ä»¶** | **~1376è¡Œ** | **å®Œæ•´æµç¨‹ç®¡ç†åç«¯** |

---

## ğŸ” è´¨é‡éªŒè¯

### **ç¼–è¯‘å’Œè¿è¡ŒéªŒè¯**
```bash
âœ… Goæ¨¡å—ä¾èµ–æ­£ç¡®
âœ… Wireä»£ç ç”ŸæˆæˆåŠŸ
âœ… é¡¹ç›®ç¼–è¯‘é€šè¿‡
âœ… åç«¯æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ
âœ… æ•°æ®åº“è¿ç§»æ‰§è¡ŒæˆåŠŸ
```

### **æ•°æ®åº“éªŒè¯**
ä»æœåŠ¡å™¨æ—¥å¿—æ˜¾ç¤ºï¼š
```bash
âœ… process_definitionsè¡¨åˆ›å»ºæˆåŠŸ
âœ… process_instancesè¡¨åˆ›å»ºæˆåŠŸ
âœ… task_instancesè¡¨åˆ›å»ºæˆåŠŸ
âœ… æ‰€æœ‰ç´¢å¼•å’Œå¤–é”®çº¦æŸæ­£ç¡®
âœ… è¿ç§»æ‰§è¡Œæ—¶é—´<3ç§’
```

### **æ¶æ„éªŒè¯**
```bash
âœ… Wireä¾èµ–æ³¨å…¥æ­£å¸¸å·¥ä½œ
âœ… åˆ†å±‚æ¶æ„æ¸…æ™°
âœ… é”™è¯¯å¤„ç†å®Œå–„
âœ… æ—¥å¿—è®°å½•è¯¦ç»†
âœ… æƒé™æ§åˆ¶å®Œæ•´
```

---

## ğŸ¯ è®¾è®¡äº®ç‚¹

### **1. å®Œæ•´çš„ç‰ˆæœ¬ç®¡ç†**
- æµç¨‹key + versionå”¯ä¸€ç´¢å¼•
- è‡ªåŠ¨ç‰ˆæœ¬å·é€’å¢
- ç‰ˆæœ¬å†å²æŸ¥è¯¢
- å‘å¸ƒçŠ¶æ€æ§åˆ¶

### **2. æƒé™æ§åˆ¶æœºåˆ¶**
- åŸºäºåˆ›å»ºè€…çš„æƒé™éªŒè¯
- çŠ¶æ€æ§åˆ¶ç¼–è¾‘æƒé™
- JWTè®¤è¯ä¿æŠ¤æ‰€æœ‰æ¥å£
- è¯¦ç»†çš„æƒé™æ—¥å¿—è®°å½•

### **3. æ•°æ®éªŒè¯ç³»ç»Ÿ**
- æµç¨‹å®šä¹‰ç»“æ„éªŒè¯
- èŠ‚ç‚¹è¿çº¿å®Œæ•´æ€§æ£€æŸ¥
- å¼€å§‹/ç»“æŸèŠ‚ç‚¹è§„åˆ™éªŒè¯
- è‡ªå®šä¹‰éªŒè¯å™¨é›†æˆ

### **4. ä¼ä¸šçº§ç‰¹æ€§**
- è½¯åˆ é™¤æ”¯æŒ
- å®¡è®¡æ—¥å¿—è®°å½•
- åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–
- æœç´¢å’Œç­›é€‰åŠŸèƒ½

---

## ğŸš€ Day 2 å‡†å¤‡

Day 1çš„å®Œæˆä¸ºDay 2æä¾›äº†ï¼š

### **å·²å®Œæˆçš„åç«¯åŸºç¡€**
- âœ… å®Œæ•´çš„æµç¨‹æ•°æ®æ¨¡å‹
- âœ… ç¨³å®šçš„APIæ¥å£
- âœ… æƒé™æ§åˆ¶æœºåˆ¶
- âœ… æ•°æ®éªŒè¯ç³»ç»Ÿ

### **Day 2 å¼€å‘é‡ç‚¹**
- ReactFlowåº“é›†æˆå’Œé…ç½®
- è‡ªå®šä¹‰èŠ‚ç‚¹ç»„ä»¶å¼€å‘
- å¯è§†åŒ–æµç¨‹è®¾è®¡å™¨
- èŠ‚ç‚¹å·¥å…·æ å’Œå±æ€§é¢æ¿

### **æŠ€æœ¯åŸºç¡€å°±ç»ª**
- åç«¯APIå®Œæ•´ä¸”ç»è¿‡ç¼–è¯‘éªŒè¯
- æ•°æ®åº“è¡¨ç»“æ„æ­£ç¡®åˆ›å»º
- Wireä¾èµ–æ³¨å…¥æ­£å¸¸å·¥ä½œ
- ä¸ºå‰ç«¯å¼€å‘æä¾›ç¨³å®šçš„æ•°æ®æ”¯æ’‘

---

## ğŸ“ˆ é¡¹ç›®è¿›åº¦è¯„ä¼°

### **å®Œæˆåº¦ç»Ÿè®¡**
- **ç¬¬1å‘¨**: ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ âœ… (100%)
- **ç¬¬2å‘¨Day 1**: æµç¨‹ç®¡ç†åç«¯ âœ… (100%)
- **æ€»ä½“è¿›åº¦**: çº¦15% (1.2/12å‘¨)

### **ä»£ç è´¨é‡**
- âœ… éµå¾ªGoæœ€ä½³å®è·µ
- âœ… å®Œæ•´çš„ä¾èµ–æ³¨å…¥
- âœ… ç»Ÿä¸€çš„é”™è¯¯å¤„ç†
- âœ… è¯¦ç»†çš„æ—¥å¿—è®°å½•
- âœ… ä¼ä¸šçº§æ•°æ®æ¨¡å‹è®¾è®¡

### **æŠ€æœ¯å€ºåŠ¡**
- æ— é‡å¤§æŠ€æœ¯å€ºåŠ¡
- æ¶æ„è®¾è®¡ä¼˜è‰¯
- ä»£ç è´¨é‡é«˜

---

## ğŸ¯ å…³é”®æˆå°±

Day 1å®Œæˆäº†ä»ç”¨æˆ·ç®¡ç†åˆ°æµç¨‹ç®¡ç†çš„é‡è¦æ‰©å±•ï¼š

- **æ•°æ®æ¨¡å‹è®¾è®¡** - æ”¯æŒå¤æ‚æµç¨‹å®šä¹‰å’Œå®ä¾‹ç®¡ç†
- **ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ** - ä¼ä¸šçº§çš„æµç¨‹ç‰ˆæœ¬ç®¡ç†
- **æƒé™æ§åˆ¶æœºåˆ¶** - å®‰å…¨çš„å¤šç”¨æˆ·æµç¨‹ç®¡ç†
- **APIæ¥å£ä½“ç³»** - å®Œæ•´çš„RESTfulæµç¨‹ç®¡ç†API

### **æŠ€æœ¯æ¶æ„å‡çº§**
- **ä»å•ä¸€ç”¨æˆ·ç®¡ç†** â†’ **ç”¨æˆ·+æµç¨‹åŒé‡ç®¡ç†**
- **ä»é™æ€æ•°æ®** â†’ **åŠ¨æ€æµç¨‹å®šä¹‰**
- **ä»ç®€å•CRUD** â†’ **å¤æ‚ä¸šåŠ¡é€»è¾‘**
- **ä»åŸºç¡€API** â†’ **ä¼ä¸šçº§æµç¨‹API**

---

**Day 1å¼€å‘å®Œæˆæ—¶é—´**: Monday 18:00  
**ä¸‹ä¸€é˜¶æ®µ**: Day 2 - ReactFlowé›†æˆå’Œå¯è§†åŒ–å»ºæ¨¡å™¨  
**é¡¹ç›®çŠ¶æ€**: æµç¨‹ç®¡ç†åç«¯åŸºç¡€å®Œæ•´ï¼Œå‡†å¤‡å‰ç«¯å¼€å‘ ğŸš€

## ğŸ‰ æ€»ç»“

ç¬¬2å‘¨Day 1ä¸ä»…å®Œæˆäº†è®¡åˆ’çš„æ‰€æœ‰ä»»åŠ¡ï¼Œæ›´é‡è¦çš„æ˜¯å»ºç«‹äº†MiniFlowæµç¨‹å¼•æ“çš„æ ¸å¿ƒæ•°æ®åŸºç¡€ï¼š

- **å®Œæ•´çš„æ•°æ®æ¨¡å‹** - æ”¯æŒå¤æ‚çš„æµç¨‹å®šä¹‰å’Œæ‰§è¡Œ
- **ä¼ä¸šçº§åç«¯æ¶æ„** - åˆ†å±‚æ¸…æ™°ï¼ŒåŠŸèƒ½å®Œæ•´
- **ç¨³å®šçš„APIæ¥å£** - ä¸ºå‰ç«¯å¼€å‘æä¾›å¯é æ”¯æ’‘
- **é«˜è´¨é‡ä»£ç å®ç°** - éµå¾ªæœ€ä½³å®è·µï¼Œæ˜“äºç»´æŠ¤

è¿™ä¸ºDay 2çš„ReactFlowå¯è§†åŒ–å»ºæ¨¡å™¨å¼€å‘å¥ å®šäº†åšå®çš„æŠ€æœ¯åŸºç¡€ï¼
